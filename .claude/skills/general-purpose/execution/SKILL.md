---
name: execution
description: 計画に従ってタスクを実行するプロセスをガイドするスキル。子エージェントへのタスク依頼、並列実行管理、進行状況監視を支援する。「実行して」「execution」「タスクを実行」「計画を実行」「実装開始」「実行プロセス」「タスク実行開始」などのフレーズで発動。前提条件として計画プロセスの成果物（task-plan.md等）が必要。
---

# Execution（実行プロセス）

計画に基づいてタスクを子エージェントに依頼し、並列実行を管理するワークフローガイド。

## 前提条件

実行開始前に以下を確認:

1. **計画成果物の存在**: `task-plan.md`（タスク一覧・依存関係）
2. **出力先ディレクトリ**: `${TASK_DIR}/04_実行/` が作成済み
3. **実行履歴ファイル**: `${TASK_DIR}/実行履歴.md` が初期化済み

計画がない場合 → planningスキルを先に実行

## 実行フロー

```
1. 計画書（task-plan.md）を読み込み
   ↓
2. タスク依存関係を解析 → 並列グループを特定
   ↓
3. 実行可能タスクの出力先ディレクトリを作成
   ↓
4. タスクを子エージェントに依頼（並列可能なら同時依頼）
   ↓
5. 完了待機 → 実行履歴を更新
   ↓
6. 次の実行可能タスクを特定 → ステップ3へ戻る
   ↓
7. 全タスク完了 → 最終レポート作成
```

## タスク依頼の手順

### Step 1: 出力先ディレクトリの事前作成

```bash
# 各タスクの出力先を事前作成
mkdir -p "${TASK_DIR}/04_実行/task01"
mkdir -p "${TASK_DIR}/04_実行/task02-01"
mkdir -p "${TASK_DIR}/04_実行/task02-02"
```

### Step 2: 子エージェントへの依頼

依頼プロンプトに必ず含める情報:

| 項目 | 説明 |
|------|------|
| リポジトリ | 作業対象のパス |
| タスク識別子 | `task01`, `task02-01` 等 |
| 成果物出力先 | 絶対パスで指定（必須） |
| 前提タスク成果物 | 参照すべき成果物のパス |
| 具体的な作業内容 | 計画書から抽出 |

**依頼テンプレート**:

```markdown
## 作業情報
- リポジトリ: {repository-path}
- タスク識別子: {task-id}
- 成果物出力先: {EXECUTION_DIR}/{task-id}/（絶対パス）
- 前提成果物: {前提タスクの出力先パス}

## 期待される成果物
- `result.md` - タスク実行結果レポート（必須）
- {その他タスク固有の成果物}

## 実行内容
1. 前提条件タスクの結果を確認
2. {具体的なタスク内容}を実装
3. コード品質チェック（lint, test等）
4. 変更内容をドキュメント化
```

### Step 3: 結果の確認と記録

タスク完了時、実行履歴ファイルを更新:

```markdown
### {task-id}: {タスク名}
- **ステータス**: ✓ 完了
- **完了時刻**: {timestamp}
- **成果物出力先**: {path}
- **生成された成果物**: {ファイル一覧}
- **結果概要**: {サマリー}
```

## 並列実行管理

### タスク識別子の形式

| パターン | 例 | 意味 |
|----------|-----|------|
| 単一実行 | `task01`, `task02` | 順次実行タスク |
| 並列実行 | `task02-01`, `task02-02` | 同一グループの並列タスク |
| ネスト | `task04-01-a` | サブタスク |

### 並列実行の判定

```
依存関係がない or 共通の前提タスクが完了済み
  → 同時に依頼可能（並列グループ）
```

### 管理ルール

1. **依存関係マップ**: 計画書から抽出し、前提タスク完了を確認
2. **並列グループ化**: 同時実行可能なタスク群を特定
3. **進行状況監視**: 実行履歴ファイルを継続更新
4. **ブロッカー管理**: 依存タスク未完了時は待機

## 期待される成果物

各タスク完了時に `result.md` を作成。含める内容:

- 実装完了状況
- 変更ファイル一覧
- テスト結果
- 品質チェック結果
- 次タスクへの依存情報

## 問題発生時の対応

| 状況 | 対応 |
|------|------|
| タスク失敗 | 原因を記録、再依頼または代替案を検討 |
| ブロッカー発生 | 実行履歴に記録、依存タスクの完了を待機 |
| 品質チェック失敗 | 修正依頼を発行、完了後に再チェック |

## リファレンス

詳細な依頼テンプレートと実行履歴の形式は [references/templates.md](references/templates.md) を参照。
