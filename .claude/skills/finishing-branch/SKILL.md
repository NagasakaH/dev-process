---
name: finishing-branch
description: 実装完了、全テスト通過後、作業を統合する方法を決定する際に使用。マージ、PR、クリーンアップの選択肢を提示して開発作業の完了をガイドする。「ブランチ完了」「マージ」「PR作成」などのフレーズで発動。
---

# ブランチ完了スキル

開発作業の完了を明確な選択肢の提示と選択されたワークフローの実行でガイドします。

## 主要機能

### プロセス

1. **テスト検証**: テストが通ることを確認
2. **ベースブランチ決定**: main/masterから分岐したか確認
3. **オプション提示**: 4つの選択肢を提示
4. **選択実行**: 選択されたワークフローを実行
5. **Worktreeクリーンアップ**: 必要に応じて削除

### 4つの選択肢

```
実装完了。次に何をしますか？

1. ローカルで <base-branch> にマージ
2. プッシュしてPRを作成
3. ブランチをそのまま保持（後で対応）
4. この作業を破棄
```

## クイックリファレンス

| オプション        | マージ | プッシュ | Worktree保持 | ブランチ削除 |
| ----------------- | ------ | -------- | ------------ | ------------ |
| 1. ローカルマージ | ✓      | -        | -            | ✓            |
| 2. PR作成         | -      | ✓        | ✓            | -            |
| 3. そのまま       | -      | -        | ✓            | -            |
| 4. 破棄           | -      | -        | -            | ✓（強制）    |

## レッドフラグ

**絶対にしない:**
- テスト失敗のまま進む
- マージ結果のテスト検証なし
- 確認なしで作業削除

## 使用タイミング

- 実装完了後
- 全テスト通過後
- 作業統合方法の決定時

## project.yaml への記録

選択した最終アクション実行後、`project.yaml` の `finishing` セクションを更新してください：

```yaml
finishing:
  status: completed
  started_at: "2025-01-15T13:30:00+09:00"
  completed_at: "2025-01-15T14:00:00+09:00"
  action: merge  # merge | pr | keep | discard
  pr_url: "https://github.com/org/repo/pull/42"  # PR作成時のみ
  merge_commit: "abc1234"  # マージ時のみ
```

### actionの値

| action    | 説明                             |
| --------- | -------------------------------- |
| `merge`   | ローカルでベースブランチにマージ |
| `pr`      | プッシュしてPR作成               |
| `keep`    | ブランチをそのまま保持           |
| `discard` | 作業を破棄                       |

## 関連スキル

- 前提: `code-review` - コードレビュー承認後
- 参照元: `commit` - コミット後ワークフロー
- 参照元: `implement` - 全バッチ完了後
- 参照: [README.md#finishing-branch-自動化手順](../../README.md#finishing-branch-自動化手順) - 自動化コマンド例
- 参照: [docs/templates/pr-template.md](../../docs/templates/pr-template.md) - PRテンプレート
